<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Malware Analysis of Trojan Try to Hide with Anti-Reverse | Esra NurSOYLU </title> <meta name="description" content=" Malware Analysis of Trojan Try to Hide with Anti-Reverse "> <meta name="keywords" content="pentester, purple teamer, csoc engineer, soc t2 analyst"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Esra Nur SOYLU"> <meta property="article:section" content="malware,, analysis,, trojen"> <meta property="article:tag" content=""> <meta property="article:published_time" content="2019-03-06 00:00:00 +0300"> <meta property="og:url" content="http://localhost:4000/malware-analysis-of-trojan-try-to-hide-with-anti-reverse.html"> <meta property="og:title" content=" Malware Analysis of Trojan Try to Hide with Anti-Reverse | Esra NurSOYLU "> <meta property="og:image" content="http://localhost:4000"> <meta property="og:description" content=" Malware Analysis of Trojan Try to Hide with Anti-Reverse "> <meta property="og:site_name" content="Esra Nur SOYLU"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="naoumine"> <meta name="twitter:title" content=" Malware Analysis of Trojan Try to Hide with Anti-Reverse | Esra NurSOYLU "> <meta name="twitter:description" content=" Malware Analysis of Trojan Try to Hide with Anti-Reverse "> <meta name="twitter:image:src" content="http://localhost:4000"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" Malware Analysis of Trojan Try to Hide with Anti-Reverse | Esra NurSOYLU "> <meta itemprop="description" content=" Malware Analysis of Trojan Try to Hide with Anti-Reverse "> <meta itemprop="image" content="http://localhost:4000"> <!-- Canonical link tag --> <link rel="canonical" href="http://localhost:4000/malware-analysis-of-trojan-try-to-hide-with-anti-reverse.html"> <link rel="alternate" type="application/rss+xml" title="Esra NurSOYLU" href="http://localhost:4000/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon.ico"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="http://localhost:4000/">Esra Nur<span>SOYLU</span></a></h1> <ul class="navbar"> <li><a href="http://localhost:4000/about">WhoAmI</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-03-06T00:00:00+03:00" itemprop="datePublished">Mar 6, 2019</time></p> <h1 class="post-title" itemprop="name headline">Malware Analysis of Trojan Try to Hide with Anti-Reverse</h1> </header> <div class="post-content" itemprop="articleBody"> <p>The hacker, who is the malware writer, tries to prevent the code from being detected and analyzed by a reverse engineer by making a number of obfusucating code or packaging to prevent the code from being recognized. But each program that uses obfusucating or packaging is not harmful because some legal products may use this method to prevent programs from being cracked.</p> <p>To examine these types of malware, weâ€™ll produce a trojan that is made on both our packaging and obfusucating on Kali ourselves.</p> <p><img src="../assets/images/2019-03-06/01.png" alt="Malware Analysis of Trojan Try to Hide with Anti-Reverse" /></p> <p>I created and encoded the malware file. And then I pack it with UPX.</p> <p><img src="../assets/images/2019-03-06/02.png" alt="Malware Analysis of Trojan Try to Hide with Anti-Reverse" /></p> <p>When we uploaded the file to VirusTotal, that told us it was harmful.</p> <p><img src="../assets/images/2019-03-06/03.png" alt="Malware Analysis of Trojan Try to Hide with Anti-Reverse" /></p> <p><img src="../assets/images/2019-03-06/04.png" alt="Malware Analysis of Trojan Try to Hide with Anti-Reverse" /></p> <p>Using the PEID, which is one of the tools used in the malware analysis phase, we can see whether the malicious file is packaged.</p> <p><img src="../assets/images/2019-03-06/05.png" alt="Malware Analysis of Trojan Try to Hide with Anti-Reverse" /></p> <p>The UPX1, which we see in the EP Section, tells us that the file is packaged. I opened the code with the UPX opener.</p> <p><img src="../assets/images/2019-03-06/06.png" alt="Malware Analysis of Trojan Try to Hide with Anti-Reverse" /></p> <p>When I analyzed the code with the strings tool; It is seen that DLL files like ntdll.dll, shel32, ws2_32, mswsock, advapi32, kernel32 are used by malicious.</p> <p><img src="../assets/images/2019-03-06/07.png" alt="Malware Analysis of Trojan Try to Hide with Anti-Reverse" /></p> <p>What happens in these files:</p> <p><strong>Ntdll.dll:</strong> This dll file is not imported directly. Windows kernel is used to communicate with the operating system. Called indirectly from the Kernel32.dll file. If Ntdll.dll is being imported directly, you may be trying to store malicious functions or manipulate processes.</p> <p><strong>shell32.dll:</strong> Used to execute commands given at the command line.</p> <p><strong>ws2_32:</strong> Used to open the connection over the network.</p> <p><strong>advapi32.dll:</strong> User sided button is the dll file used for visual design, such as the drag bar and other components.</p> <p><strong>kernel32.dll:</strong> is a dll file where functions such as access, manipulation and manipulation of memory, files and hardware commonly used by malware and exploit codes are performed.</p> <aside class="share"> <p>If you liked this article and think others should read it, please share it on <a href="http://twitter.com/share?text=Malware Analysis of Trojan Try to Hide with Anti-Reverse&amp;url=http://localhost:4000/malware-analysis-of-trojan-try-to-hide-with-anti-reverse.html&amp;via=naoumine" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> or <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/malware-analysis-of-trojan-try-to-hide-with-anti-reverse.html" onclick="window.open(this.href, 'facebook-share', 'width=550,height=235');return false;">Facebook</a>.</p> </aside> </div> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2019 Esra Nur SOYLU &middot; &lt;/&gt; Powered by <a href="https://ghost.org/">Ghost</a> | <a href="http://localhost:4000/feed.xml" target="_blank">RSS</a></small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-83161908-4']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>

<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> ‘Natas’ Solutions 1-12 | Esra NurSOYLU </title> <meta name="description" content=" ‘Natas’ Solutions 1-12 "> <meta name="keywords" content="pentester, purple teamer, csoc engineer, soc t2 analyst"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Esra Nur SOYLU"> <meta property="article:section" content="natas,, hacking"> <meta property="article:tag" content=""> <meta property="article:published_time" content="2019-05-06 00:00:00 +0300"> <meta property="og:url" content="http://localhost:4000/natas-solutions-1-12.html"> <meta property="og:title" content=" ‘Natas’ Solutions 1-12 | Esra NurSOYLU "> <meta property="og:image" content="http://localhost:4000"> <meta property="og:description" content=" ‘Natas’ Solutions 1-12 "> <meta property="og:site_name" content="Esra Nur SOYLU"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="naoumine"> <meta name="twitter:title" content=" ‘Natas’ Solutions 1-12 | Esra NurSOYLU "> <meta name="twitter:description" content=" ‘Natas’ Solutions 1-12 "> <meta name="twitter:image:src" content="http://localhost:4000"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" ‘Natas’ Solutions 1-12 | Esra NurSOYLU "> <meta itemprop="description" content=" ‘Natas’ Solutions 1-12 "> <meta itemprop="image" content="http://localhost:4000"> <!-- Canonical link tag --> <link rel="canonical" href="http://localhost:4000/natas-solutions-1-12.html"> <link rel="alternate" type="application/rss+xml" title="Esra NurSOYLU" href="http://localhost:4000/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon.ico"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="http://localhost:4000/">Esra Nur<span>SOYLU</span></a></h1> <ul class="navbar"> <li><a href="http://localhost:4000/about">WhoAmI</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-05-06T00:00:00+03:00" itemprop="datePublished">May 6, 2019</time></p> <h1 class="post-title" itemprop="name headline">‘Natas’ Solutions 1-12</h1> </header> <div class="post-content" itemprop="articleBody"> <p><img src="../assets/images/2019-05-06/01.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Natas teaches the basics of serverside web-security.</p> <h2 id="1">1.</h2> <p><img src="../assets/images/2019-05-06/02.png" alt="‘Natas’ Solutions 1-12" /></p> <p>This was a simple question. We looked at the source code of the page.</p> <p><img src="../assets/images/2019-05-06/03.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="2">2.</h2> <p><img src="../assets/images/2019-05-06/04.png" alt="‘Natas’ Solutions 1-12" /></p> <p>If right click is blocked , we use browser shortcuts to open the debugger.</p> <p><img src="../assets/images/2019-05-06/05.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="3">3.</h2> <p><img src="../assets/images/2019-05-06/06.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Okeyi Let’s look source code.</p> <p><img src="../assets/images/2019-05-06/07.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Source reveals a hidden image located at /files/pixel.png.</p> <p><img src="../assets/images/2019-05-06/08.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Navigating to /files/, we see the file /files/users.txt which contains the password.</p> <p><img src="../assets/images/2019-05-06/09.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="4">4.</h2> <p><img src="../assets/images/2019-05-06/10.png" alt="‘Natas’ Solutions 1-12" /></p> <p>When we look source code, a comment in the source says:</p> <p><img src="../assets/images/2019-05-06/11.png" alt="‘Natas’ Solutions 1-12" /></p> <p>“[…] Not even Google will find it this time…”. Google indexes the web, but honours a site’s <code class="highlighter-rouge">robots.txt</code> file, which tells crawlers not to visit web pages.</p> <p><img src="../assets/images/2019-05-06/12.png" alt="‘Natas’ Solutions 1-12" /></p> <p>The <code class="highlighter-rouge">robots.txt</code> excludes the contents of <code class="highlighter-rouge">/s3cr3t/</code>. Looking in this folder we find a file <code class="highlighter-rouge">user.txt</code> which contains the password.</p> <p><img src="../assets/images/2019-05-06/13.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="5">5.</h2> <p><img src="../assets/images/2019-05-06/14.png" alt="‘Natas’ Solutions 1-12" /></p> <p>We can trick the server into thinking we’ve come from that URL by adding the Referer header to our HTTP request: <code class="highlighter-rouge">“http://natas5.natas.labs.overthewire.org/”</code></p> <p><img src="../assets/images/2019-05-06/15.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="6">6.</h2> <p><img src="../assets/images/2019-05-06/16.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Inspecting the site, we see that the following cookie has been set: <code class="highlighter-rouge">loggedin=0</code></p> <p><img src="../assets/images/2019-05-06/17.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Change this cookie to 1, and the password is returned.</p> <p><img src="../assets/images/2019-05-06/18.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="7">7.</h2> <p><img src="../assets/images/2019-05-06/19.png" alt="‘Natas’ Solutions 1-12" /></p> <p>In the source code, we see an included file <code class="highlighter-rouge">/includes/secret.inc</code>.</p> <p><img src="../assets/images/2019-05-06/20.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Navigating to this page, we see that the secret is <code class="highlighter-rouge">FOEIUWGHFEEUHOFUOIU</code>. Enter this secret to get the password.</p> <p><img src="../assets/images/2019-05-06/21.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="8">8.</h2> <p><img src="../assets/images/2019-05-06/22.png" alt="‘Natas’ Solutions 1-12" /></p> <p><img src="../assets/images/2019-05-06/23.png" alt="‘Natas’ Solutions 1-12" /></p> <p>A clue in the source says that the password we’re looking for is stored at <code class="highlighter-rouge">/etc/natas_webpass/natas8</code> on the server. If we navigate to the Home or About page, we can change the value of page in the URL query to hit other files on disk.</p> <p>The query <code class="highlighter-rouge">?page=../../../../etc/natas_webpass/natas8</code> reveals the password.</p> <p><img src="../assets/images/2019-05-06/24.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="9">9.</h2> <p><img src="../assets/images/2019-05-06/25.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Looking at the source code, we see that the secret, when encoded must match:<code class="highlighter-rouge">3d3d516343746d4d6d6c315669563362</code>.</p> <p><img src="../assets/images/2019-05-06/26.png" alt="‘Natas’ Solutions 1-12" /></p> <p>To find out the clear text secret, we can reverse the encoding steps:</p> <p><img src="../assets/images/2019-05-06/27.png" alt="‘Natas’ Solutions 1-12" /></p> <p><img src="../assets/images/2019-05-06/28.png" alt="‘Natas’ Solutions 1-12" /></p> <p><img src="../assets/images/2019-05-06/28_2.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Submit this secret to see the password.</p> <p><img src="../assets/images/2019-05-06/29.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="10">10.</h2> <p><img src="../assets/images/2019-05-06/30.png" alt="‘Natas’ Solutions 1-12" /></p> <p>Looking at the source code, we see that PHP passthru function.</p> <p><img src="../assets/images/2019-05-06/31.png" alt="‘Natas’ Solutions 1-12" /></p> <p>In this level, user input is passed to the PHP passthru function: <code class="highlighter-rouge">“passthru(“grep -i $key dictionary.txt”);”</code> We can terminate the grep with a semicolon, run an arbitrary command, and comment any code that comes after with: <code class="highlighter-rouge">; cat /etc/natas_webpass/natas10 #</code></p> <p><img src="../assets/images/2019-05-06/32.png" alt="‘Natas’ Solutions 1-12" /></p> <h2 id="11">11.</h2> <p><img src="../assets/images/2019-05-06/33.png" alt="‘Natas’ Solutions 1-12" /></p> <p>This level is the same as level 10.</p> <p><img src="../assets/images/2019-05-06/34.png" alt="‘Natas’ Solutions 1-12" /></p> <table> <tbody> <tr> <td>But the characters ;,</td> <td>and &amp; are blocked by the server. We can utilise the grep to search for everything in the password file:</td> </tr> </tbody> </table> <p><code class="highlighter-rouge">.* /etc/natas_webpass/natas11 #</code></p> <p><img src="../assets/images/2019-05-06/35.png" alt="‘Natas’ Solutions 1-12" /></p> <aside class="share"> <p>If you liked this article and think others should read it, please share it on <a href="http://twitter.com/share?text=‘Natas’ Solutions 1-12&amp;url=http://localhost:4000/natas-solutions-1-12.html&amp;via=naoumine" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> or <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/natas-solutions-1-12.html" onclick="window.open(this.href, 'facebook-share', 'width=550,height=235');return false;">Facebook</a>.</p> </aside> </div> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2019 Esra Nur SOYLU &middot; &lt;/&gt; Powered by <a href="https://ghost.org/">Ghost</a> | <a href="http://localhost:4000/feed.xml" target="_blank">RSS</a></small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-83161908-4']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>

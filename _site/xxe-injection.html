<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> XXE Injection | Esra NurSOYLU </title> <meta name="description" content=" XXE Injection "> <meta name="keywords" content="pentester, purple teamer, csoc engineer, soc t2 analyst"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Esra Nur SOYLU"> <meta property="article:section" content="xxe"> <meta property="article:tag" content=""> <meta property="article:published_time" content="2019-01-10 00:00:00 +0300"> <meta property="og:url" content="https://naoumine.com/xxe-injection.html"> <meta property="og:title" content=" XXE Injection | Esra NurSOYLU "> <meta property="og:image" content="https://naoumine.com"> <meta property="og:description" content=" XXE Injection "> <meta property="og:site_name" content="Esra Nur SOYLU"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="naoumine"> <meta name="twitter:title" content=" XXE Injection | Esra NurSOYLU "> <meta name="twitter:description" content=" XXE Injection "> <meta name="twitter:image:src" content="https://naoumine.com"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" XXE Injection | Esra NurSOYLU "> <meta itemprop="description" content=" XXE Injection "> <meta itemprop="image" content="https://naoumine.com"> <!-- Canonical link tag --> <link rel="canonical" href="https://naoumine.com/xxe-injection.html"> <link rel="alternate" type="application/rss+xml" title="Esra NurSOYLU" href="https://naoumine.com/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="https://naoumine.com/assets/css/main.css"> <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon.ico"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://naoumine.com/">Esra Nur<span>SOYLU</span></a></h1> <ul class="navbar"> <li><a href="https://naoumine.com/about">WhoAmI</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-01-10T00:00:00+03:00" itemprop="datePublished">Jan 10, 2019</time></p> <h1 class="post-title" itemprop="name headline">XXE Injection</h1> </header> <div class="post-content" itemprop="articleBody"> <p>XML, the eXtensible Markum Language, is a mark language designed to standardize data communication between data exchange systems and platforms using the Internet.</p> <p>The XML Injection vulnerability is triggered by invoking the specially defined entity while parsing the XML data. Parsing the XML data is the process of making the data understandable by the applications. Exploit of weakness the vulnerability, the XML library must allow the entity to define and invoke an entity, while in some libraries this property is explicit by default. Using this vulnerability, we can read files containing sensitive information.</p> <p>Example 1:</p> <p><img src="../assets/images/2019-01-10/01.png" alt="XXE Injection" /></p> <p>We have a simple Login page as above. I started the review using the Burp Suite.</p> <p><img src="../assets/images/2019-01-10/02.png" alt="XXE Injection" /></p> <p>I’ve tried to send a “test” between the tags, and it turns me into a hash encoded with base64 as the X-Auth-Policy (Authentication Policy).</p> <p>When I decode this hash:</p> <p><img src="../assets/images/2019-01-10/03.png" alt="XXE Injection" /></p> <p>After decoding Hash, we see plain-text de storage: secret.txt, path: / main directory, principal: token (The contents of the secret.txt file are token)</p> <p><img src="../assets/images/2019-01-10/04.png" alt="XXE Injection" /></p> <p>When we go to the secret.txt file in the main directory, “Congratulations, You Hacked Me !!!” We see the text.</p> <p>Example 2:</p> <p><img src="../assets/images/2019-01-10/05.png" alt="XXE Injection" /></p> <p>The first thing we will do is log in to the burp suite by clicking on the forgot pwd, which is the part of the weakness from the login page.</p> <p><img src="../assets/images/2019-01-10/06.png" alt="XXE Injection" /></p> <p>At the <code class="highlighter-rouge"><span class="cp">&lt;!DOCTYPE Test [&lt;!ENTITY test “EsraNSoylu”&gt;</span>]&gt;</code> payload we determine the experiment variable and we want to print a string named EsraNSoylu. We inject our payload, and when we look at Response, we see that the XML parser parses what we send and suppresses the EsraNSoylu string. This indicates that the XXE injection deficiency exists and no measures have been taken.</p> <p><img src="../assets/images/2019-01-10/07.png" alt="XXE Injection" /></p> <p>How to protect us from this vulnerability ?</p> <ul> <li>The safest way is to completely deactivate DTD (Document Type Definition) in Java with similar method depending on the parser.</li> <li>In PHP you can disable libxml extensions.</li> </ul> <aside class="share"> <p>If you liked this article and think others should read it, please share it on <a href="http://twitter.com/share?text=XXE Injection&amp;url=https://naoumine.com/xxe-injection.html&amp;via=naoumine" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> or <a href="https://www.facebook.com/sharer/sharer.php?u=https://naoumine.com/xxe-injection.html" onclick="window.open(this.href, 'facebook-share', 'width=550,height=235');return false;">Facebook</a>.</p> </aside> </div> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2019 Esra Nur SOYLU &middot; &lt;/&gt; Powered by <a href="https://ghost.org/">Ghost</a> | <a href="https://naoumine.com/feed.xml" target="_blank">RSS</a></small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-83161908-4']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>
